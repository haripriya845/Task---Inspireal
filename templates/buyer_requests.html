<!DOCTYPE html>
<html>
<head>
    <title>My Requests</title>
    <style>
        body { font-family: Arial; background:#f5f6fa; padding:20px; }
        h2 { text-align:center; }
        .list { max-width:900px; margin:20px auto; }
        .card { background:white; padding:15px; margin-bottom:15px;
            border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.15); }
        .paid { color:green; font-weight:bold; }
        .unpaid { color:orange; font-weight:bold; }
        .status { font-weight:bold; }
        .logout { position:fixed; right:20px; top:20px; background:#dc3545; color:white;
            padding:8px 12px; border-radius:6px; text-decoration:none; }
        .btn { padding:8px 12px; background:#28a745; color:white;
            text-decoration:none; display:inline-block; border-radius:5px; }
    </style>
</head>
<body>

<a href="/logout/" class="logout">Logout</a>

<h2>My Purchase Requests</h2>

<div class="list">
    {% for r in requests %}
        <div class="card">
            <h3>{{ r.listing.name }}</h3>

            <p><b>Requested Qty:</b> {{ r.requested_quantity }} {{ r.listing.unit }}</p>

            <p><b>Status:</b> 
                <span class="status">{{ r.get_status_display }}</span>
            </p>

            {% if r.total_amount %}
                <p><b>Total Amount:</b> ${{ r.total_amount }}</p>
            {% endif %}

            {% if r.payment_status == "paid" %}
                <p class="paid">Payment: PAID</p>
            {% else %}
                <p class="unpaid">Payment: UNPAID</p>
                {% if r.status == "accepted" %}
                    <a class="btn" href="/buyer/requests/{{ r.id }}/pay/">Mark as Paid</a>
                {% endif %}
            {% endif %}
        </div>
    {% empty %}
        <p>No requests found.</p>
    {% endfor %}
</div>

</body>
</html>
